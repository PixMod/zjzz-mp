<view class="container">
  <view class="bg-container">
    <view class="bg-group {{activeBg === 'A' ? 'show' : ''}} {{isPreviewing ? 'preview-mode' : ''}}">
      <image class="bg-layer blur" src="{{bgImageA}}" mode="aspectFill"></image>
      <image class="bg-layer origin {{isCaseA ? 'lift-up' : ''}}" src="{{bgImageA}}" mode="{{bgModeA}}"></image>
    </view>
    <view class="bg-group {{activeBg === 'B' ? 'show' : ''}} {{isPreviewing ? 'preview-mode' : ''}}">
      <image class="bg-layer blur" src="{{bgImageB}}" mode="aspectFill"></image>
      <image class="bg-layer origin {{isCaseB ? 'lift-up' : ''}}" src="{{bgImageB}}" mode="{{bgModeB}}"></image>
    </view>
  </view>
  <image class="decoration-layer {{currentPageIndex === 2 ? 'hidden' : ''}}" src="{{icoPath}}/decoration-bg.png"
    mode="widthFix"></image>
  <view class="header-fixed">
    <view class="grid-title-container">
      <image class="title-bg" src="{{icoPath}}/fixed-header-bg.png" mode="widthFix"></image>
      <text>浙建智造</text>
    </view>
  </view>
  <view class="side-indicator">
    <block wx:for="{{[0,1,2,3]}}" wx:key="*this">
      <view class="dot {{currentPageIndex === index ? 'active' : ''}}"></view>
    </block>
  </view>
  <swiper class="main-swiper" vertical="true" bindchange="onSwiperChange" bindtransition="onSwiperTransition"
    bindanimationfinish="onSwiperAnimationFinish" current="{{currentPageIndex}}">
    <swiper-item class="page">
      <view class="page-item">
        <view class="logo-box">
          <image src="{{icoPath}}/logo.png" mode="heightFix" class="logo-img"></image>
        </view>
        <view class="card" style="background: rgb(0,0,0,0.1);">
          <view class="card-title">{{intro.title}}</view>
          <scroll-view class="card-body">
            <view style="word-break: break-all">{{intro.content}}</view>
          </scroll-view>
        </view>
      </view>
    </swiper-item>

    <swiper-item class="page">
      <view class="page-item">
        <view class="card" style="background: rgb(0,0,0,0.1);">
          <view class="card-title">{{business.title}}</view>
          <scroll-view scroll-y class="card-body">
            <view class="list-header">
              <image src="{{icoPath}}/list-header-bg.png"></image>
              <text>{{business.header}}</text>
            </view>
            <view class="ul">
              <block wx:for="{{business.segments}}" wx:key="name">
                <view class="li">
                  {{item.name}}：{{item.description}}
                </view>
                <view class="ul sub-ul" wx:if="{{item.sub && item.sub.length > 0}}">
                  <block wx:for="{{item.sub}}" wx:for-item="subItem" wx:key="*this">
                     <view class="li sub-li">{{subItem}}</view>
                  </block>
                </view>
              </block>
            </view>
          </scroll-view>
        </view>
      </view>
    </swiper-item>

    <swiper-item class="page">
      <view class="page-item" style="justify-content: flex-end; padding-bottom: 420rpx;">
        <swiper class="case-swiper" circular="true" autoplay="true" interval="7000" duration="500"
          bindchange="onCaseChange">
          <block wx:for="{{caseList}}" wx:key="id">
            <swiper-item style="display: flex; flex-direction: column; justify-content: flex-end; align-items: center; height: 100%;">
              
              <view class="dynamic-card">
                <view class="card-title" style="margin-bottom: 0rpx; margin-top: 0rpx;">案例介绍</view>
                <scroll-view scroll-y class="card-body">
                  <view class="list-header2">
                    <image src="{{icoPath}}/list-header-bg.png" mode="aspectFit"></image>
                    <text>{{item.title}}</text>
                  </view>
                  <view class="ul">
                    <block wx:for="{{item.items}}" wx:for-item="subItem" wx:key="*this">
                      <view class="li">{{subItem}}</view>
                    </block>
                  </view>
                  <view class="view-photos-btn" bindtap="goToSitePhotos">
                    <text>查看施工图片</text>
                    <text class="arrow">⋙</text>
                  </view>
                </scroll-view>
              </view>

            </swiper-item>
          </block>
        </swiper>

        <view class="case-indicators">
          <block wx:for="{{caseList}}" wx:key="id">
            <view class="case-dot {{currentCaseIndex === index ? 'active' : ''}}"></view>
          </block>
        </view>

      </view>
    </swiper-item>

    <swiper-item class="page">
      <view class="page-item">
        <view class="card-title card-title-focus">
          <image class="focus-arrow" src="{{icoPath}}/focus-left.png" mode="aspectFit"></image>
          <text>{{contactInfo.title}}</text>
          <image class="focus-arrow right" src="{{icoPath}}/focus-left.png" mode="aspectFit"></image>
        </view>
        <view class="card-body center-text">
          <image class="qr-overlay" src="{{icoPath}}/{{contactInfo.qrcode}}" show-menu-by-longpress="{{true}}"></image>
          <image src="{{icoPath}}/{{contactInfo.qrcode}}" class="qr-code" show-menu-by-longpress="{{true}}"></image>
          <view class="hint-text">{{contactInfo.prompt}}</view>
          <view class="contact-row">
            <image src="{{icoPath}}/contact-profile.png" class="icon-small"></image>
            <text class="manager-name">{{contactInfo.name}}</text>
          </view>
        </view>
        <view class="go-top-btn" bindtap="goTop" bindtouchstart="onGoTopStart" bindtouchend="onGoTopEnd">
          <image src="{{isGoTopPressed ? icoPath + '/gotop-pressed.png' : icoPath + '/gotop-unpressed.png'}}"></image>
        </view>
      </view>
    </swiper-item>
  </swiper>

  <view class="swipe-hint-box {{currentPageIndex < 3 && !isSwiping ? 'show' : ''}}">
    <text>滑动查看更多 ▲</text>
  </view>

  <view class="tab-bar">
    <image src="{{icoPath}}/tab-bar-bg.png" class="tab-bar-bg"></image>
    <view class="tab-item active">
      <image src="{{icoPath}}/intro-selected.png" class="tab-icon"></image>
      <text class="tab-text">企业介绍</text>
    </view>
    <view class="tab-item" bindtap="goToContact">
      <image src="{{icoPath}}/contact-unselected.png" class="tab-icon"></image>
      <text class="tab-text">留下联系</text>
    </view>
  </view>
</view>